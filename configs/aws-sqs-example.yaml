# Sentinel Configuration Example - AWS SQS
#
# This example demonstrates a production configuration using AWS SQS
# as the message broker.
#
# Required environment variables:
#   BROKER_TYPE=awsSqs
#   BROKER_REGION=us-east-1
#   BROKER_QUEUE_URL=https://sqs.us-east-1.amazonaws.com/123456789012/hyperfleet-events
#
# Optional environment variables for AWS credentials:
#   AWS_ACCESS_KEY_ID=your-access-key
#   AWS_SECRET_ACCESS_KEY=your-secret-key
#   AWS_SESSION_TOKEN=your-session-token (for temporary credentials)

# Resource type to watch - must be one of: clusters, nodepools.
resource_type: clusters

# How often to poll the HyperFleet API for resource updates.
# Accepts Go duration format: ns, us/Âµs, ms, s, m, h.
poll_interval: 5s

# Backoff interval for resources that are not ready.
# Resources in transitional states are re-checked more frequently.
max_age_not_ready: 10s

# Backoff interval for resources that are ready and stable.
# Stable resources are checked less frequently to reduce API load.
max_age_ready: 30m

# Resource selector (optional) - filter resources by labels.
# If empty or omitted, all resources of the specified type are watched.
# This enables horizontal scaling by having multiple Sentinels watch different resource subsets.
# Multiple selectors use AND logic (all labels must match).
resource_selector:
  - label: shard
    value: "1"
  - label: region
    value: us-east-1

# HyperFleet API configuration.
hyperfleet_api:
  # API base URL (required).
  endpoint: http://hyperfleet-api.hyperfleet-system.svc.cluster.local:8080

  # Request timeout for API calls.
  timeout: 5s

# Message data template configuration (optional).
# Define custom fields to include in CloudEvents data payload.
# Uses Go template syntax - both .field and {{.field}} formats are supported.
# Templates can reference any field from the Resource object returned by the API.
message_data:
  resource_id: .id
  resource_type: .kind
  href: .href
  generation: .generation

# Broker configuration is loaded from environment variables.
# For AWS SQS, set:
#   BROKER_TYPE=awsSqs
#   BROKER_REGION=us-east-1
#   BROKER_QUEUE_URL=https://sqs.us-east-1.amazonaws.com/123456789012/hyperfleet-events
#
# Authentication uses AWS credentials:
# - In EKS: Uses IAM Roles for Service Accounts (IRSA).
# - Locally: Set AWS_ACCESS_KEY_ID and AWS_SECRET_ACCESS_KEY.
# - In EC2: Uses instance profile credentials.
#
# The SQS queue should have appropriate permissions for the Sentinel service to send messages.
